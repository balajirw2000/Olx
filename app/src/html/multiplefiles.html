<html>
  <head>
    <script src="../main.js"></script>
  </head>
  <body>
    <form id="file-form">
      <input type="file" id="file-input" multiple />
      <button type="submit">Upload Files</button>
    </form>
    <script>
      const form = document.getElementById("file-form");
      const input = document.getElementById("file-input");
      const API_KEY = "cf407cf24626f4936422";
      const SECRET_API_KEY =
        "eed79e2e7cb8b60c6c8188d64f728d27845620259c3cc112afc40a86b620218a";

      form.addEventListener("submit", async (event) => {
        event.preventDefault();

        const files = input.files;

        const imgArr = [];

        for (let i = 0; i < files.length; i++) {
          const file = files[i];
          const formData = new FormData();
          formData.append("file", file);

          const options = {
            method: "POST",
            headers: {
              pinata_api_key: API_KEY,
              pinata_secret_api_key: SECRET_API_KEY,
            },
            body: formData,
          };

          const response = await fetch(
            "https://api.pinata.cloud/pinning/pinFileToIPFS",
            options
          );
          const json = await response.json();
          console.log(json);

          imgArr.push(json["IpfsHash"]);
        }

        console.log("imgArr ", imgArr);
        App.setPropertyImages(1, imgArr);
      });

      // window.onload(App.getPropertyImages(1));
    </script>
  </body>
</html>
